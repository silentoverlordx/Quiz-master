<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>QuizVerse | Login</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Bungee&family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Inter', sans-serif; }
    h1 { font-family: 'Bungee', cursive; }
    .input-glow:focus {
      box-shadow: 0 0 15px rgba(236, 72, 153, 0.7);
      border-color: #ec4899;
    }
    .gradient-btn {
      background-size: 200% 200%;
      background-image: linear-gradient(270deg, #fbbf24, #ec4899, #8b5cf6, #fbbf24);
      animation: gradientShift 4s ease infinite;
      color: white;
      font-weight: bold;
      border-radius: 12px;
      padding: 0.5rem 1rem;
      cursor: pointer;
      transition: 0.3s;
    }
    .gradient-btn:hover { transform: scale(1.05); }
    @keyframes gradientShift {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }
  </style>
</head>
<body class="min-h-screen flex items-center justify-center bg-gradient-to-tr from-indigo-900 via-purple-800 to-indigo-900 text-white px-4">

<div class="w-full max-w-md bg-white text-gray-900 rounded-2xl shadow-2xl p-8 space-y-6">
  <h1 class="text-3xl text-center font-bold text-transparent bg-clip-text bg-gradient-to-r from-pink-500 via-purple-500 to-amber-400">
    üîë Login
  </h1>

  <form id="login-form" class="space-y-4">
    <input type="email" id="email" placeholder="Email" class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:outline-none input-glow" required>
    <input type="password" id="password" placeholder="Password" class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:outline-none input-glow" required>
    <button type="submit" id="login-btn" class="w-full py-3 rounded-lg gradient-btn">Login</button>
  </form>

  <p class="text-sm text-center text-gray-600">
    Don‚Äôt have an account? 
    <a href="signup.html" class="text-pink-500 font-semibold hover:underline">Sign up</a>
  </p>
</div>

<!-- Supabase -->
<script src="config.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.39.7/dist/umd/supabase.min.js"></script>
<script>
  const supabase = window.supabase.createClient(window.SUPABASE_URL, window.SUPABASE_KEY);

  // If already logged in ‚Üí jump to lobby
  (async () => {
    const { data } = await supabase.auth.getSession();
    if (data.session) window.location.href = "lobby.html";
  })();

  // Handle login
  document.getElementById("login-form").addEventListener("submit", async (e) => {
    e.preventDefault();
    const email = document.getElementById("email").value.trim();
    const password = document.getElementById("password").value.trim();
    const btn = document.getElementById("login-btn");

    btn.disabled = true;
    btn.innerText = "‚è≥ Logging in...";

    const { data, error } = await supabase.auth.signInWithPassword({ email, password });

    if (error) {
      alert("‚ùå " + error.message);
      btn.disabled = false;
      btn.innerText = "Login";
    } else {
      // üöÄ Redirect instantly
      window.location.href = "lobby.html";
    }
  });
</script>

</body>
</html>
