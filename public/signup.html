<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>QuizVerse | Sign Up</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Bungee&family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Inter', sans-serif; }
    h1 { font-family: 'Bungee', cursive; }

    @keyframes floatCard { 0%,100%{transform:translateY(0)}50%{transform:translateY(-10px)} }
    .floating { animation: floatCard 5s ease-in-out infinite; }

    @keyframes fadeInUp { 0%{opacity:0;transform:translateY(40px)}100%{opacity:1;transform:translateY(0)} }
    .fade-in { animation: fadeInUp 0.8s ease-out forwards; }

    .input-glow:focus { box-shadow:0 0 15px rgba(255,193,7,.7); border-color:#fbbf24; }
    .avatar { transition:transform .3s, border-color .3s; cursor:pointer; }
    .avatar:hover { transform:scale(1.15); border-color:#ec4899; }

    .gradient-btn { background-size:200% 200%;
      background-image:linear-gradient(270deg,#fbbf24,#ec4899,#8b5cf6,#fbbf24);
      animation:gradientShift 4s ease infinite;
    }
    @keyframes gradientShift {0%{background-position:0% 50%}50%{background-position:100% 50%}100%{background-position:0% 50%}}
    .gradient-btn:hover { box-shadow:0 0 20px rgba(236,72,153,.8); transform:scale(1.05); }

    .modal { position:fixed; inset:0; background:rgba(0,0,0,0.7); display:none;
      align-items:center; justify-content:center; z-index:50; }
    .modal-content { background:white; color:#1f2937; padding:2rem; border-radius:1rem;
      text-align:center; max-width:400px; animation:fadeInUp .5s ease; }
    .close-btn { margin-top:1rem; padding:.5rem 1.5rem; background:#ec4899; color:white;
      border-radius:9999px; font-weight:bold; transition:.3s; }
    .close-btn:hover { background:#db2777; transform:scale(1.05); }
  </style>
</head>
<body class="min-h-screen flex items-center justify-center bg-gradient-to-tr from-indigo-900 via-purple-800 to-indigo-900 text-white px-4">

  <!-- Signup Card -->
  <div class="w-full max-w-md bg-white text-gray-900 rounded-2xl shadow-2xl p-8 space-y-6 floating fade-in">
    <h1 class="text-3xl text-center font-bold text-transparent bg-clip-text bg-gradient-to-r from-amber-400 via-pink-500 to-purple-500">
      üöÄ Create Account
    </h1>
    <p class="text-center text-gray-600">Battle, Learn & Rule the leaderboard üéÆ</p>

    <form id="signup-form" class="space-y-4">
      <div>
        <label class="block text-sm font-semibold mb-1">Username</label>
        <input type="text" id="username" placeholder="Enter your gamer name" class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:outline-none input-glow" required>
      </div>
      <div>
        <label class="block text-sm font-semibold mb-1">Email</label>
        <input type="email" id="email" placeholder="your@email.com" class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:outline-none input-glow" required>
      </div>
      <div>
        <label class="block text-sm font-semibold mb-1">Password</label>
        <input type="password" id="password" placeholder="Choose a strong password" class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:outline-none input-glow" required>
      </div>
      <div>
        <label class="block text-sm font-semibold mb-1">Choose Avatar</label>
        <div class="flex gap-4">
          <img src="https://api.dicebear.com/7.x/fun-emoji/svg?seed=Ace" class="avatar w-12 h-12 rounded-full border-2 border-transparent">
          <img src="https://api.dicebear.com/7.x/fun-emoji/svg?seed=Nova" class="avatar w-12 h-12 rounded-full border-2 border-transparent">
          <img src="https://api.dicebear.com/7.x/fun-emoji/svg?seed=Luna" class="avatar w-12 h-12 rounded-full border-2 border-transparent">
        </div>
      </div>
      <button type="submit" class="w-full py-3 rounded-lg font-bold text-white gradient-btn transition-all">
        ‚ú® Sign Up
      </button>
    </form>

    <p class="text-sm text-center text-gray-600">
      Already have an account?
      <a href="login.html" class="text-pink-500 font-semibold hover:underline">Log in</a>
    </p>
  </div>

  <!-- Modal -->
  <div id="success-modal" class="modal">
    <div class="modal-content">
      <div id="modal-icon" class="text-green-500 text-5xl mb-3">‚úÖ</div>
      <h2 id="modal-title" class="text-xl font-bold mb-2">Account Created!</h2>
      <p id="modal-message" class="text-gray-600">Please check your email to verify your account.</p>
      <button class="close-btn" onclick="closeModal()">Got it</button>
    </div>
  </div>

  <script src="config.js"></script>
  <script>
    const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

    let selectedAvatar = null;
    document.querySelectorAll('.avatar').forEach(img => {
      img.addEventListener('click', () => {
        document.querySelectorAll('.avatar').forEach(i => i.classList.remove('border-pink-500'));
        img.classList.add('border-pink-500');
        selectedAvatar = img.src;
      });
    });

    document.getElementById("signup-form").addEventListener("submit", async (e) => {
      e.preventDefault();

      const username = document.getElementById("username").value.trim();
      const email = document.getElementById("email").value.trim();
      const password = document.getElementById("password").value;
      const avatar_url = selectedAvatar || "https://api.dicebear.com/7.x/fun-emoji/svg?seed=Default";

      const { data, error } = await supabase.auth.signUp({
        email,
        password,
        options: {
          data: { username, avatar_url }
        }
      });

      if (error) {
        showModal("‚ùå", "Signup Failed", error.message, "red");
      } else {
        showModal("‚úÖ", "Account Created!", "Please check your email to verify your account.", "green");
        confetti({ particleCount: 150, spread: 80, origin: { y: 0.6 } });
      }
    });

    function showModal(icon, title, message, color) {
      document.getElementById("modal-icon").textContent = icon;
      document.getElementById("modal-icon").className = `text-${color}-500 text-5xl mb-3`;
      document.getElementById("modal-title").textContent = title;
      document.getElementById("modal-message").textContent = message;
      document.getElementById("success-modal").style.display = "flex";
    }

    function closeModal() {
      document.getElementById("success-modal").style.display = "none";
    }
  </script>
</body>
</html>